I. INTRODUCTION

The spread of diseases has been a prominent feature of human civilization. The devastation that epidemics can bring worldwide, both from loss of life, and, less importantly, from hindrance to economic activity, has been brought into stark relief by the ongoing Covid-19 crisis. Consequently, understanding the causes of spread of diseases, and, as a result, possibly mitigating (or eradicating) the spread have been questions of longstanding interest for the scientific community. The earliest work in this area can be traced back to [1] . In recent times, modeling and analysis of spreading processes has attracted the attention of researchers across a wide spectrum ranging from mathematical epidemiology [1, 2] and physics [3] to the social sciences [4] .Various models have been proposed in the literature for studying spreading processes, and, in particular, epidemics, viz. susceptible-exposed-infected-recovered (SEIR), susceptible-infected-susceptible (SIS), susceptible-infectedrecovered (SIR), susceptible-infected (SI), and susceptibleinfected-recovered-infected (SIRI). An overview of these models is provided in [5] , and [6] , respectively. The present paper relies on the SIS model, which was first introduced in [7] . In an SIS model, an agent (resp. node), which can be interpreted as either an individual or, equivalently, a community, is either in the infected state or in the susceptible state. Assuming there is a non-trivial disease-spread in a population, an agent that is in the susceptible state, as a consequence of interactions with its neighbors, and depending on its infection rate, transitions to the infected state; an agent that is in the infected state recovers from the infections based on its healing rate.SIS networked models have been studied extensively in the literature, both for continuous-time and discrete-time settings; see, for instance, [3, 8] - [10] and [11] - [13] , respectively. However, [3, 8, 9, 12, 13] only account for time-invariant interconnections among the agents. Overcoming this drawback, SIS networked models with time-varying topologies have been developed and analysed in [14] - [16] . Nonetheless, the bulk of the existing literature on SIS models factors in only person-toperson interaction. However, diseases can spread also through other medium, such as water [17] (or infected surfaces, e.g., in hospitals [18] , public transit vehicles [19] , etc). Water-borne pathogens could spread through infrastructure networks, water distribution systems (e.g., rivers, groundwater, and reservoirs) [20] . Moreover, while water quality issues are very prevalent in developing countries with less advanced plumbing and sewage infrastructure, such issues occasionally affect more prosperous countries as well. Notably, Sweden has had a number of water contamination incidents which have affected thousands of residents. For example, inÖstersund in Northern Sweden, approximately 27, 000 people (∼45% of the population) became ill and had a water-boil order for over two months as the result of Cryptosporidium contamination of the drinking water [21] . Hence, there is a need for SIS networked models that also account for the spread of diseases through water distribution networks.Based on the aforementioned motivation, the so-called Susceptible-Infected-Water-Recovered (SIWR) model had been proposed in [22] - [24] by adding a water compartment to the classical SIR model. More recently, a variant of the SIS model called the Susceptible-Infected-Water-Susceptible (SIWS) model has been recently developed in [25] , and a multi-virus single resource SIWS model in [26] . The paper [25] provides sufficient conditions for GAS of the healthy state (see [25, Theorem 1] ), but it does not provide any theoretical guarantees regarding endemic behavior. More recently, sufficient conditions for GAS of the healthy state, and also for the existence, uniqueness, and GAS of the endemic state have been provided in [26] ; see [26, Theorem 2] , and [26, Theorem 3] , respectively. However, both [25] and [26] consider only the presence of a single resource. Notice that if there are multiple water resources being accessed by the population, then the spread of virus could be due to not only node-to-node interaction and node-to-resource interactions, but also due to resource-to-resource interaction. The present paper aims to develop such a model (called the layered networked SIWS model), and provide an in-depth analysis of its various equilibria viz. existence, uniqueness, and stability. Based on the aforementioned analysis, we would also focus on understanding the effect on the endemic level of the population nodes in the presence of shared resource(s) as compared to the absence of the same.While the discussion insofar has been centered around modeling and analysis, another pressing challenge that health administration officials face is to estimate the contamination levels in the infrastructure network. In particular, for largescale infrastructure networks (as is the case with modern societies), it is not economically viable to install sensors everywhere. However, by employing system-theoretic notions such as observability 1 , one could address the aforementioned challenge by deploying as few sensors as possible. One of the earliest works in this direction is [27] , where the problem of which subset of nodes in a network should be measured so as to improve observability of a SIS network is addressed; the condition therein involves checking the determinant of the inverse of the observability Grammian. Inspired by the work in [27] , we aim to address the following question: under what conditions can we estimate the contamination levels in the infrastructure network by only measuring the infection levels of individuals in the population? Furthermore, given knowledge of such conditions, can we glean any insights into how the measurement matrix might be designed so that the contamination levels in the infrastructure network can be recovered purely by measuring the infection levels of individuals in the population? The key theoretical tool that we would be using to answer these questions is the notion of local weak observability of non-linear systems 2 .Paper Contributions: For the layered networked SIWS model that accounts for the presence of multiple resources, our main contributions are as follows:(i) We identify conditions such that regardless of whether or not an agent (resp. infrastructure resource) is infected or healthy, the model converges to the healthy state, i.e., conditions for global asymptotic stability (GAS) of the healthy state; see Theorem 1. (ii) We provide conditions that guarantee the existence, uniqueness, and GAS of the endemic equilibrium; see Theorem 2. (iii) We show that the endemic equilibrium in the population nodes for the layered networked SIWS model is greater than or equal to the endemic equilibrium of the population nodes in the networked SIS model, with at least one of the population nodes in the former having a strictly greater endemic level than in the latter; see Proposition 5. (iv) Assuming all nodes in the human contact network are initially healthy, we provide a necessary and sufficient condition for local weak observability of the layered networked SIWS model; see Theorem 3. Additionally, we also have the following auxiliary contributions: a necessary, and sufficient, condition for the healthy state to be the unique equilibrium of the model; see Corollary 1. A sufficient (but not necessary) condition for local weak observability of the layered networked SIWS model, and, based off of this sufficient condition, we present a design of the observability matrix that results in the layered networked SIWS model being locally weakly observable; see Proposition 6 and Corollary 2, respectively.A preliminary version of this paper appeared in [29] . The present paper involves a more comprehensive treatment by providing theoretical guarantees for the endemic behavior, novel sufficient conditions for local weak observability, complete proofs of all assertions, and, finally, an in-depth set of simulations.Paper Organization: The paper unfolds as follows. We conclude the present section by collecting all the notation used in the rest of the paper. The layered networked SIWS model is developed in Section II, where, we subsequently, also state the problems of interest. The analysis of the various equilibria of the model, namely stability of the healthy state and existence, uniqueness, and stability of the endemic state, is given in Section III. The observability problem is studied in Section IV. Simulations illustrating our theoretical findings are provided in Section V. Finally, some concluding remarks, together with some research directions of possible interest to the wider community, are provided in Section VI.Notation: For any positive integer n, we use [n] to denote the set {1, 2, . . . , n}. The ith entry of a vector x will be denoted by x i . We use 0 and 1 to denote the vectors whose entries all equal 0 and 1, respectively, and use I to denote the identity matrix. For any vector x ∈ IR n , we use diag(x) to denote the n × n diagonal matrix whose ith diagonal entry equals x i . For any two sets A and B, we use A \ B to denote the set of elements in A but not in B. For any two real vectors a, b ∈ IR n , we write a ≥ b if a i ≥ b i for all i ∈ Given a matrix A, A ≺ 0 (resp. A 0) indicates that A is negative definite (resp. negative semidefinite), whereas A 0 (resp. A 0) indicates that A is positive definite (resp. positive semidefinite).

II. THE MODEL

In this section, we develop a distributed continuous-time pathogen model. This model will be hereafter referred to as the layered networked SIWS model; see Figure 1 .A. The layered networked SIWS model Consider a pathogen spreading over a two-layer network consisting of n > 1 groups of individuals and m > 1 infrastructure compartments. The individuals in a group could become contaminated as a consequence of their interactions with other infected individuals and/or as a consequence of their interactions with infected infrastructure compartments.We denote by I i (t) and S i (t) the number of infected and susceptible individuals, respectively, in group i at time t ≥ 0. We denote by N i the total number of individuals in group i, and assume that N i does not change over time, i.e., S i (t) + I i (t) = N i for all i ∈ [n] and t ≥ 0, This assumption implies that the birth and death rates for each group are equal. Thus, it simplifies the model. The healing rate of each group i is denoted by γ i , the birth rate by µ i , the death rate byμ i (which equals µ i ), the person-to-person infection rates by a ij and the infrastructure-to-person infection rates by a w ij . In the rest of this paper, we will assume that all of the aforementioned parameters are nonnegative. We assume that the individuals are susceptible at birth regardless of whether (or not) their parents are infected. The evolution of the numbers of infected and susceptible individuals in each group i is, consistent with the ideas in [30, 31] , as follows:where w j (t) denotes the pathogen concentration in the jth infrastructure compartment and evolves aṡwhere δ w j denotes the decay rate of the pathogen, ζ w jk denotes the person-infrastructure contact rate of group k to infrastructure node j, and α kj represents the flow of the pathogen from node k to node j in the infrastructure network. It is clear from (1) and (2), thatṠ i (t) +İ i (t) = 0, which is consistent with our assumption that N i is a constant.We simplify the model further by defining the fraction of infected individuals in each group i as

Human Contact Network

Water Network By defining the following parameters (1), (2) , and (3), it follows thaṫNote that, we also allow for the healing rate of an infrastructure compartment j, δ w j , to be zero. The model from (4)-(5) in vector form becomes:where B = [β ij ] n×n , X = diag(x), B w = [β w ij ] n×m , A w has off-diagonal entries equal to α kj and diagonal entries equal to − k α kj , and C w = [c w jk ] m×n . Therefore, the columns of A w sum to zero. System (6)-(7) could be written more compactly using, and (8).With the new notations in place, (6)- (7) can be rewritten as:Remark 1. We highlight how the model considered in the present paper is connected with similar models in the existing literature i) If m = 1, (9) coincides with the model in [25] , and with the multi-virus model in [26] , when the latter is particularized for the single-virus case. ii) If w j (t) = 0 for all t and all j ∈ [m], or equivalently, there is no coupled infrastructure network, (9) reduces to the regular networked SIS model in [32] .

B. Problem Statements

In the sequel, for the model in (9), we will be interested in addressing the following problems:(i) Identify a condition such that z(t) converges asymptotically to the healthy state, i.e., z = 0. (ii) Under what conditions does there exist an endemic equilibriumẑ > 0, and under such conditions, does the system converge asymptotically toẑ from any non-zero initial condition? (iii) Letẑ = xŵ , wherex (resp.ŵ) denotes the endemic equilibrium of the population nodes (resp. the shared resources). Letx denote the unique endemic equilibrium of the SIS model without a shared resource. What is the relation betweenx andx? (iv) Identify a necessary, and sufficient, condition such that, given x(t), z(0) can be uniquely recovered.

C. Positivity Assumptions

We impose the following assumptions on the parameters., and β ij > 0 whenever group j is a neighbor of group i.Since each x i represents the fraction of infected individuals in group i, it is immediate that the initial value of x i is in [0, 1], because otherwise the value of x i will lack physical meaning for the epidemic model considered here. Similarly, it is also natural to assume that the initial value of w j (measured, for instance, in milligrams per litre) is nonnegative. Hence, we can restrict our analysis to the set:The following lemma establishes that the set D is positively invariant.Lemma 1. Suppose that Assumption 1 holds. Suppose that. If w j (τ ) = 0, then from (5) and Assumption 1,. If x i (τ ) = 0, then from (4) and Assumption 1,ẋ i (τ ) ≥ 0. If x i (τ ) = 1, then again from (4) and Assumption 1,ẋ i (τ ) < 0. Therefore, x i (t) will be in [0, 1] for all times t ≥ τ .Since the above arguments hold for any i ∈ [n] and any j ∈for all i ∈ [n] and w j (0) ≥ 0 for all j ∈ [m], the lemma follows by setting τ = 0.

III. STABILITY ANALYSIS OF THE EQUILIBRIA

In this section, we analyze the equilibria of the proposed model and their stability both locally and globally.

A. Local Stability of the Healthy State

Consider (x,w), an equilibrium of (6)- (7) . The Jacobian matrix of the equilibrium, denoted by J(x,w), iswhereX, F 1 , F 2 are diagonal matrices given bỹIn the case whenx = 0 andw = 0, i.e., at the healthy state (also referred to as the disease-free equilibrium),If either B w = 0 or C w = 0, i.e., the pathogen does not affect the population or humans can not contaminate the infrastructure network by using it, we have the following result.and B w = 0 or C w = 0, then the healthy state (0, 0) of (6)- (7) is locally exponentially stable.Proof: If B w = 0 or C w = 0 then J(0, 0) is a triangular matrix (lower or upper, respectively), and therefore the spectrum of the matrix is equal to the union of the spectrum of the two block matrices on the diagonal. Consequently, if s 1 (B − D) < 0 and s 1 (A w − D w ) < 0 then J(0, 0) is Hurwitz and by Lyapunov's indirect method [33] the healthy state (0, 0) of (6)- (7) is locally exponentially stable.For nonzero B w and C w , we have the following result. (7) is locally exponentially stable.Proof : See Appendix.

B. Global Stability of the Healthy State

To state our first main result, we need the following concept. Consider an autonomous systemẋ(t) = f (x(t)), where f : D → IR n is a locally Lipschitz map from a domain D ⊂ IR n into IR n . Letx be an equilibrium of the system and E ⊂ D be a domain containingx. The equilibriumx is called asymptotically stable with the domain of attraction E if for anyThe global stability of the healthy state is characterized by the following theorem.1 and B f is irreducible, then the healthy state of (6)- (7) is asymptotically stable with the domain of attraction D, with D given in (10) .Proof: See Appendix. Theorem 1 addresses Question (i) in Section II-B.

C. Reproduction Number

In epidemiology the reproduction number, R 0 , is the average number of people that become infected from one infected individual. If R 0 > 1 the disease will lead to an outbreak; if R 0 ≤ 1 the disease will die out. For the networked SIS model with no water compartments, it has been shown that ρ(D −1 B) is the reproduction number, and that if ρ(D −1 B) ≤ 1, the model will asymptotically converge to the healthy state for all initial conditions, and if ρ(D −1 B) > 1, the model will asymptotically converge to a unique epidemic state for all initial conditions except for the healthy state [30] .For the layered networked SIWS model (6)-(7), Theorem 1 implies that when ρ(D −1 f B f ) ≤ 1, the model will asymptotically converge to the healthy state for all initial conditions, which implies that the healthy state is the unique equilibrium. We call ρ(D −1 f B f ) the basic reproduction number of the layered networked SIWS model (6)-(7), and compare its value with that of the networked SIS model, ρ(D −1 B), to illustrate the effect of the water distribution network. Note thatWe need the following lemma. Since D −1 f B f is an irreducible nonnegative matrix by Assumption 1, and since D −1 B is a principal square submatrix. Therefore we have the following result.Proposition 3. Suppose that Assumption 1 holds. Then, the basic reproduction number of the layered networked SIWS model (6)-(7) is greater than that of the networked SIS model. Proposition 3 implies that eradication of the disease in the population in itself does not guarantee that the system is disease-free. That is, the presence of infrastructure network makes the system more vulnerable to SIS-type diseases than otherwise.

D. Analysis of the endemic behavior

It turns out that the condition in Proposition 1 being violated results in the instability of the healthy state (0, 0) of (6)- (7), as we show in the following proposition. Proof: Since by assumption, B w = 0 (resp. C w = 0), it follows that the Jacobian matrix of the equilibrium evaluated at the healthy state, i.e., J(0, 0), is a block lower triangular (resp. upper triangular) matrix. Hence, the eigenvalues of J(0, 0) are same as those of matrices B − D and A w − D w . Consequently, if s(B − D) > 0 and/or s(A w − D w ) > 0, then s(J(0, 0)) > 0. Hence, the healthy state (0, 0) of (6)- (7) is unstable.Simulations indicate the existence of an endemic state (also referred to as the endemic equilibrium) when the eigenvalue condition in Theorem 1 is violated (see Figure 4 in Section V), a rigorous result, however, remains missing. Therefore, we consider the following variant of Assumption 1.Assumption 2 states that the system parameters, with the exception of the rate of flow of pathogen within a resource node, are nonnegative. It is easy to show that Assumption 2 implies Assumption 1, and, is, thus, more restrictive. Hence, we only need Assumption 2 in the sequel. Proof: See Appendix. Theorem 2 says that as long as the reproduction number of the layered SIWS network is greater than one, then, assuming that there is at least one node (population or infrastructure) that is infected initially, the spreading process converges to a unique proportion in each population node, and a unique infection level in each infrastructure node. Thus, Theorem 2 addresses Question (ii) in Section II-B. Note that Theorem 2 improves upon [26, Theorem 3] since it also accounts for multiple shared resources.Combining Theorems 1 and 2 yields a necessary, and sufficient, condition for the healthy state to be the unique equilibrium of (6)- (7) . Hence, we have the following result: Proposition 1] tells us that insofar the linearized state matrix of system (9) (linearized around the healthy state) is Hurwitz, the healthy state is the only equilibrium of system (9) .A very pertinent question that could arise at this point is as follows: focusing solely on the population, is there a relation between the endemic equilibrium of the layered networked SIWS model, and that of the networked SIS model. In order to answer this, we recall the latter:In order to ensure that the model in (15) is well-defined, we need to particularize Assumption 2, for the setting without shared resource(s). This is given as follows:Letx denote the unique endemic equilibrium of (15) and z = x w denote the unique endemic equilibrium of (9). With this notation and Assumption 3 in place, we present the following result. Proof : See Appendix.Proposition 5 says that the endemic level in each of the population nodes for the layered networked SIWS model is greater than or equal to the endemic level of the population nodes in the absence of shared resource(s). As such, it addresses Question (iii) in Section II-B.

IV. OBSERVABILITY PROBLEM

In this section, we aim to address the following question: Assuming enough sensors to detect waterborne pathogens are not available, can measurements of the sickness level of people, or households, who drink the water be used to estimate the contamination level of the water, or the source of the contamination (the initial condition of the water pathogen levels). We introduce the following notation:where C ∈ R q×n is a measurement matrix, with q ∈ Z + denoting the number of measurements needed. The problem posed in Question (iv) could be re-written as follows: Given B, D, A w , B w , C w , D w , C, and measurements y, find conditions for when w(0) can be recovered.We derive conditions such that, given measurements of sickness levels of households, it is possible to uniquely recover the initial state of the water pathogen levels. Towards this end, we appeal to the rank of the Jacobian of the Lie derivatives, and apply the results from [28] . Consequently, the Lie derivative calculations are as follows:whereẋ andẇ are defined in (6) and (7),We explore the case when we assume that all nodes in the human contact network are initially healthy, that is, x(0) = 0. Therefore, we explore the Jacobian of the above Lie derivatives evaluated atFurthermore, O has q(n + m) rows, and n + m columns. Therefore, from [28, Theorems 3.1 and 3.12], and since the system is analytic, we have the following theorem. (17), has full rank.Observe that Theorem 3 provides a necessary and sufficient condition for checking whether (or not) the layered networked SIWS model is locally weakly observable at x(0) = 0, and thus answers Question (iv) in Section II-B. However, the condition therein involves checking the rank of the O matrix, which in turn, involves too many computations, since O has q(n+m) rows.. This drawback motivates us to seek a simpler, easier to check, sufficient condition for the layered networked SIWS model to be locally weakly observable at x(0) = 0, and is presented next. Proposition 6. Suppose that the matrices C and CB w have full column rank. Then the layered networked SIWS model in (6)- (7) with measurements in (16) is locally weakly observable at x(0) = 0.Proof: Define the matrixObserve that F is a block lower triangular matrix. Hence, rank(F) ≥ rank(C) + rank(CB w ). By assumption, matrices C and CB w have full column rank, which implies that rank(F) ≥ n + m. Observe also that the total number of columns in F equals n + m. Therefore, it follows that rank(F) ≤ n + m. Hence, rank(F) = n + m, i.e., F has full column rank. Now note that F is a submatrix of O, that has the same number of columns as O. Also observe that adding more rows to F does not lead to matrix F becoming rank deficient. This implies that matrix O has full column rank, and therefore, from Theorem 3, we conclude that the layered networked SIWS model in (6)-(7) with measurements in (16) is locally weakly observable at x(0) = 0. Given that both Proposition 6 and Theorem 3 provide sufficient conditions for local weak observability, it is natural to ask how the two conditions are related. The following remark addresses this question. it is clear that CB w does not have full column rank, so the conditions for Proposition 6 are not met. However, allowing w = (w 1 , w 2 ) to be free, we obtainTherefore, independent of the value of w, the rightmost column of O is linearly independent of the other three columns of O, that is, O has full column rank. Thus, the condition in Theorem 3 is met.We now highlight an interesting consequence of Proposition 6.Corollary 2. Let n ≥ m. If C = I n×n and B w has full column rank, then the layered networked SIWS model in (6)- (7) with measurements in (16) is locally weakly observable at x(0) = 0.Proof: Suppose that, by assumption, C = I n×n . Consequently, rank(C) = n. Moreover, CB w = B w , and hence rank(CB w ) = rank(B w ). Since, by assumption, rank(B w ) = m, it follows that the conditions in Proposition 6 are satisfied, Fig. 2 : The contact network of population and resource nodes used for simulations, represented by squares and circles, respectively. and hence the result follows. Observe that the result in Corollary 2 could potentially inform sensor placement (in the population) strategies for detecting contamination levels of water resources in the layered networked SIWS model.The condition in Proposition 6 requires the observation matrix, C, to have full column rank. This implies that q ≥ n. That is, the number of observations should at least be equivalent to the size of the population. Clearly, for a large population, this condition is quite restrictive. Hence, it is perhaps more appealing to establish conditions for local weak observability under partial measurements, which is beyond the scope of the present paper.

V. SIMULATIONS

For all simulations, we consider a network of 10 population nodes and 15 resource nodes. This network is depicted in Fig. 2 , with population nodes as squares and resource nodes as circles. We denote the average infection proportion of the virus across the population nodes byx(t), and the average contamination across the resource nodes byw(t). The terms β ij , β w ij , and α ij are all binary, i.e. equal to one whenever nodes i and j are neighbors, for all simulations. For the simulations in Fig. 3 and Fig. 4 we set c w ij to be binary which results in the network being irreducible. By choosing D = 5I, D w = 5I, we see that ρ(D −1 f B f ) < 1. Consequently, consistent with the result in Theorem 1, the virus is asymptotically eradicated across the network; see Fig. 3a .Therefore, consistent with the result in Theorem 2, the virus becomes endemic across all population and resource nodes, asymptotically approaching some positive equilibrium; see Fig. 3b . Choosing D = 4I and D w equal to a zero matrix, except for one diagonal entry equal to 100, Assumption 1 is fulfilled but Assumption 2 is violated. Therefore Theorem 2 does not apply, despite ρ(D −1 f B f ) > 1, yet the virus still appears to converge to some positive equilibrium; see Fig. 4 .For the simulations depicted in Fig. 5 we chose D = 3I, D w = 0.2I. Since D w is a positive diagonal matrix, the resource network requires some non-zero c w ij to sustain a positive level of contamination. Choosing c w ij = 0 for all i, j ensures that the contamination across all resource nodes decays to zero; see the blue curve in Fig. 5a. However, B is an irreducible matrix, and we still have ρ(D −1 B) > 1. Therefore, the infection levels in the population network converge to an Here D w has some zero entries, in violation of Assumption 2. Nonetheless, the simulation converges to some endemic equilibrium.endemic equilibrium, consistent with the results in [10, 30] ; see the red curve in Fig. 5a . Setting c w ij to be binary as before results in the contamination of the resource network converging to a positive equilibrium; see the blue curve in Fig. 5b . Consistent with the result in Proposition 5, it can be seen that in the absence of contamination in the resources, the endemic state in the population is smaller, whereas if the resources are also contaminated then the endemic state in the population is larger; see Fig. 5a and 5b, respectively.

VI. CONCLUSION

In this paper, we have developed a multi-networkdependent, continuous-time SIWS epidemic model, also referred to as a layered networked SIWS model. This model captures a networked system, which can be interpreted as individual people or multiple groups of individuals, coupled with an infrastructure network, which can be understood as a contaminated water (or some other utility) distribution network. We have analyzed the stability of the healthy state, both locally and globally. We compared the basic reproduction number of the model with the standard networked SIS model without a pathogen. We have established conditions for the existence, uniqueness, and stability of an endemic equilibrium. We have also provided a necessary and sufficient condition for the healthy state to be the only equilibrium of this model. Lastly, we have established conditions under which the initial infection levels of the shared resources could be recovered based on the measurements of the infection levels of the population.One line of future investigation could focus on understanding the spread of diseases in infrastructure networks with timevarying topologies. Another problem of interest would be to develop control algorithms that exploit the topology of the infrastructure network for virus mitigation. Still on the topic of control of epidemics, it would be interesting to mitigate (resp. eradicate) epidemics subject to constraints on the availability of healing resources. Fig. 5 : Simulations without and with population-to-resource contact. In (a) C w = 0, so the contamination of the resource nodes decays to zero. In (b) C w is non-zero, and therefore the virus becomes endemic in the resource nodes as well.

Proof of Prosition 2

To prove Proposition 2, we need the following lemma. Proof of Proposition 2: By Assumption 1, δ w j + k α kj > 0 for all j ∈ [m], D f is invertible. From Lemma 3, the condition ρ(D −1 f B f ) < 1 is equivalent to s(B f − D f ) < 0, which implies that J(0, 0) is a continuous-time stable matrix. Thus, by Lyapunov's indirect method the healthy state (0, 0) of (6)-(7) is locally exponentially stable.

Proof of Theorem 1

To prove the claim in Theorem 1, we need the following lemmas. Consider the Lyapunov function V (z(t)) = z(t) P z(t). Then, from (6)-(9), when z(t) = 0, we havėwhere the strict inequality holds by Lemma 5 sinceThus, in this case,V (z(t)) < 0 if z(t) = 0. From Lemma 1 and Lemma 7, the healthy state is asymptotically stable with domain of attraction D, with D given in (10) . Next we consider the case when ρ(D −1is negative semi-definite. Consider the Lyapunov function V (z(t)) = z(t) Qz(t). Then, from (6)-(9), we havėwhere Q 1 is the nth principal subarray of Q, which is an n × n positive diagonal matrix, and Q 2 is the m × m positive diagonal matrix that is composed of the rest of the block diagonal entries of Q. We claim thatV (z(t)) < 0 if z(t) = 0. To establish this claim, we first consider the case when z(t) 0. Since B f is irreducible and non-negative we have B f z(t) 0. As such, Bx(t) + B w w(t) 0, and due to Q 1 being a positive diagonal matrix, it follows thatNext we consider the case when z(t) > 0 and z(t) has at least one zero entry.and it has a unique (up to scalar multiple) strictly positive eigenvector corresponding to the eigenvalue zero. Thus,0 and z(t) has at least one zero entry (because the only vector for which it equals zero is the strictly positive eigenvector). Therefore,V (z(t)) < 0 if z(t) = 0. From Lemma 1 and Lemma 7, the healthy state is asymptotically stable with domain of attraction D, with D given in (10) .

Proof of Theorem 2

To prove the claim in Theorem 2, we will be making use of the following variants of the Perron-Frobenius theorem for irreducible matrices. (ii) There is an eigenvector ζ 0 corresponding to the eigenvalue r. (iii) x > 0 is an eigenvector only if N x = rx and x 0.Proof of Theorem 2: The proof is split in three parts: First we show existence of an endemic equilibrium provided the conditions in Theorem 2 are satisfied. Subsequently, we show that this equilibrium is unique, and that for all non-zero initial conditions the dynamics converge asymptotically to this equilibrium.is a nonnegative diagonal matrix, and therefore the inverse of (I + diag(D −1 f B f z)) exists. Define a map T (z) : R n+mObserve that the components of T (y) areNote that the scalar function s/(1 + s) is increasing in s, and Recall that the definition of X(z) means that subtracting (21) yieldsSince X(z) and D −1 f are diagonal matrices, they commute. Furthermore, by pre-multiplying (22) with D f , and suitably rearranging terms, we obtainA solution of equation (23) is clearly an equilibrium of (9). As such, it suffices to show that T (z) has a fixed pointz 0. We will now show that at least one such fixed point exists.We have ρ(D −1 f B f ) > 1. Note that D −1 f B f is an irreducible nonnegative matrix. Hence, by Lemma 4, λ * = ρ(D −1 f B f ) is a simple eigenvalue of D −1 f B f and the eigenspace of λ * is spanned by a vector y * 0. Then, since λ * > 1, thereObserve that, sincez 1, I −X(z) is a positive diagonal matrix. Since, by assumption, B f is irreducible, and by Assumption 2 B f is nonnegative, it follows that (I − X(z))D −1 f B f is nonnegative irreducible. Sincez 0, item iii) in Lemma 8 yields ρ((I − X(z))D −1 f B f ) = 1, which, from Lemma 3, further implies that s(−D f + (I − X(z))B f ) = 0. Therefore, since the matrix (−D f +(I −X(z))B f ) is irreducible Metzler, by Lemma 6 there exists a positive diagonal matrix Q such that Ψ :0. Define the Lyapunov function candidate V (∆z(t)) = ∆z(t) T Q∆z(t), with z(t) ∈ D \ {0} as the domain. Since Q is a positive diagonal matrix, V (∆z(t)) 0. Differentiating V (∆z(t)) with respect to t yields:V (∆z(t)) = ∆z T Ψ∆z − 2∆z T QX(B f z)∆z (38) where (38) makes use of (35) . The rest of the proof consists of showing thatV (∆z(t)) < 0 for all z(t) ∈ D \ {0} such that ∆z(t) = z(t) −z = 0. First, consider all z(t) ∈ D \ {0} such that z(t) 0. Since Ψ 0, it is immediate thaṫ V (∆z(t)) ≤ −2∆z(t) T QX(B f z(t))∆z(t).(39) Since z(t) 0, QX(B f z(t)) is a positive diagonal matrix, and thus QX(B w y(t)) 0. Therefore, from (39) it is clear thatV (∆z(t)) < 0 for all z(t) ∈ D \ {0} such that z(t) 0, ∆z(t) = z(t) −z = 0. Now, consider all z(t) ∈ D \ {0} such that z(t) > 0, z i (t) = 0 for some i ∈ [n + m]. Since z(t) > 0, QX(B w y(t)) is a nonnegative diagonal matrix. Then (38) can be bounded byV (∆z(t)) ≤ ∆z(t) T Ψ∆z(t).(40) Since (−D f +(I −X(z))B f ) is an irreducible Metzler matrix and Q is a positive diagonal matrix, Ψ is an irreducible Metzler matrix. Employing (36) , we see that z T Ψz = 0.(41) Lemma 4 stipulates that r := s(Ψ) is a simple eigenvalue of Ψ. Due to Ψ 0 and the Rayleigh-Ritz Theorem [37, Theorem 4.2.2], it follows from (41) that r = 0, and thatz spans the eigenspace of r. Hence, due toz 0, and z(t) > 0 with z i (t) = 0 for some i ∈ [n + m], z(t) can not be parallel toz. Consequently, ∆z(t) can not be parallel toz. By the Rayleigh-Ritz Theorem [37, Theorem 4.2.2], x T Ψx = rx T x only if x is parallel toz, and x T Ψx < rx T x otherwise. Therefore, r = 0 together with (40) gives usV (∆z(t)) < 0 for all z(t) ∈ D \ {0} such that z(t) 0 and z(t) −z = 0. Thus, we haveV (∆z(t)) < 0 for all z(t) ∈ D\{0} such that ∆z(t) = z(t)−z = 0, and it is clear thatV (0) = 0. Therefore, V (∆y(t)) ≺ 0 for y(t) ∈ D \ {0}. Finally, for reasons similar to that in [26, Lemma 7] , we have that D \ {0} is a positively invariant set with respect to (9) . Thus, we see that V (∆z(t)) meets the conditions for [38, Theorem 4.1] with respect to the shifted coordinates ∆z(t) = z(t) −z, for all z(t) ∈ D \ {0}. Hence, the unique endemic equilibriumz is asymptotically stable, with domain of attraction containing D \ {0}.

Proof of Proposition 5

In order to prove Proposition 5, we need the following result.Lemma 9. Consider system (15) under Assumption 3. If ρ(D −1 B) > 1, then there exists a unique endemic equilibrium x such that 0 x 1.Proof: The result follows by particularizing [26, Theorem 3] for the networked SIS model.Proof of Proposition 5: By assumption, the matrices B f and B are irreducible. Moreover, ρ(D −1 f B f ) > 1, and ρ(D −1 B) > 1. Therefore, from Theorem 2, and from Lemma 9, we know that there exists a unique endemic equilibriumẑ = [x w ] for (9) , and a unique endemic equilibrium x for (15), respectively. Moreover, 0x 1. Note that sincex is an equilibrium of (15), we haveConsider a solution z(t) = (x(t), w(t)) to (9) for t ≥ 0, with x i (0) ∈ [0, 1] and w j (0) ≥ 0 for all i ∈ [n], j ∈ [m]. By Lemma 1 we have x i (t) ∈ [0, 1] and w j (t) ≥ 0 for all i ∈ [n], j ∈ [m] and t ≥ 0. Suppose that, for some t ≥ 0, x(t) ≥x, with x i (t) =x i for some i ∈ [n]. Theṅwhere (43) follows from D −1 B w w(t) ≥ 0, and (44) follows from (42). Since the same argument holds for any t and i ∈ [n]we have x(t) ≥x for all t ≥ 0 if x(0) ≥x. Furthermore, due to (a):x 1, and (b):ẑ being the unique equilibrium of (9) with a region of attraction including {z = (x, w) : 1 ≥ x ≥ x}, we must havex ≥x. In order to showx =x, assume by way of contradiction thatx =x. Note thatWith the assumption thatx =x, (45) is equivalent tõwhere (46) 

